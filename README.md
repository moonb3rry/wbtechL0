# WB Tech: Level #0 (Golang)

## Описание
Этот сервис предназначен для отображения данных о заказах. Он использует PostgreSQL для хранения данных, NATS-streaming для подписки на каналы и имеет простой интерфейс для просмотра данных о заказе по его ID.

## Основные функции
- Подключение и подписка на канал в NATS-streaming.
- Запись полученных данных в PostgreSQL.
- Кэширование полученных данных в памяти сервиса.
- Восстановление кэша из БД при перезапуске сервиса.
- HTTP-сервер для получения данных заказа по ID из кэша.
- Простой веб-интерфейс для отображения данных о заказе.
- Сервис предусматривает обработку случаев, когда в канал могут быть отправлены некорректные данные.

## Установка и запуск
1. Установите Docker и Go.
2. Запустите приложение с помощью команды
```bash
docker compose up
go run cmd/app/main.go
```
для запуска публикаций в канал nats:
```bash
go run cmd/publisher/publisher.go
```
для запуска интерфейса откройте `templates/index.html` в браузере.

3. Введите ID заказа в поле ввода и нажмите "Отправить". 
4. Просмотрите детали заказа в отображаемом ниже разделе.

## Конфигурация Docker Compose

В файле `docker-compose.yml` содержатся следующие сервисы:
1. **postgres**: Этот сервис использует образ Docker `postgres:15`. Он настраивает контейнер базы данных PostgreSQL и связывает каталог `./volumes/pgdata` на хост-машине с папкой `/var/lib/postgresql/data` внутри контейнера. Данные базы данных будут храниться в указанном каталоге на хост-машине, обеспечивая сохранность данных. Сервис также использует файл окружения `.env` для загрузки переменных окружения, если он присутствует. Сервис доступен на порту `5555` на хост-машине, который отображается на порт `5436` внутри контейнера.
2. **nats**: Этот сервис использует образ Docker `nats-streaming:latest`. Он настраивает контейнер сервера NATS Streaming и открывает порты `4222` на хост-машине, которые отображаются на соответствующие порты внутри контейнера.
